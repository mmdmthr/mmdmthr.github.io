{"componentChunkName":"component---src-templates-blog-post-js","path":"/2022/02/melihat-raw-query-database-eloquent-laravel/","result":{"data":{"site":{"siteMetadata":{"title":"Dev Jurnal","author":"mmdmthr","siteUrl":"https://mmdmthr.github.io","comment":{"disqusShortName":"","utterances":"mmdmthr/devjurnal"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"0f607fe2-291b-58c2-bafd-8c10320c4744","excerpt":"Ada kalanya kita perlu melakukan debuging pada query eloquent, \nmungkin saat menemukan query model yang kita buat tidak menampilkan data sesuai ekspektasi. \nKita bisa melihat query apa yang dibuat saat menjalankan model eloquent. Menggunakan Laravel Eloquent Method Eloquent…","html":"<p>Ada kalanya kita perlu melakukan debuging pada query eloquent,\nmungkin saat menemukan query model yang kita buat tidak menampilkan data sesuai ekspektasi.\nKita bisa melihat query apa yang dibuat saat menjalankan model eloquent.</p>\n<h3 id=\"menggunakan-laravel-eloquent-method\" style=\"position:relative;\"><a href=\"#menggunakan-laravel-eloquent-method\" aria-label=\"menggunakan laravel eloquent method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Menggunakan Laravel Eloquent Method</h3>\n<p>Eloquent menyediakan method yang mengembalikan string query tanpa menjalankannya yaitu method <code class=\"language-text\">toSql()</code>.\nIni sesuai jika kita hanya ingin melihat query saja tanpa ingin mengubah data –\ntetapi cara ini tidak menampilkan seluruh kueri jika kuerinya lebih kompleks atau jika memiliki subkueri.</p>\n<p>Contoh Kode</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token class-name class-name-fully-qualified static-context\">App<span class=\"token punctuation\">\\</span>User</span><span class=\"token operator\">::</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'&lt;'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">subYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-></span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'assignedApps'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'courses'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-></span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'email'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'asc'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-></span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-></span><span class=\"token function\">toSql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Output</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">select <span class=\"token operator\">*</span> from <span class=\"token string backtick-quoted-string\">`users`</span> where <span class=\"token string backtick-quoted-string\">`created_at`</span> <span class=\"token operator\">&lt;</span> <span class=\"token operator\">?</span> order by <span class=\"token string backtick-quoted-string\">`email`</span> asc limit <span class=\"token number\">5</span></code></pre></div>\n<h3 id=\"menggunakan-laravel-query-log\" style=\"position:relative;\"><a href=\"#menggunakan-laravel-query-log\" aria-label=\"menggunakan laravel query log permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Menggunakan Laravel Query Log</h3>\n<p>Aktifkan log query untuk menangkap query yang dijalankan, perlu diperhatikan bahwa\nquery log akan menangkap query yang dijalankan oleh model. Ini berarti query sudah\nselesai dijalankan di database. Cara untuk mengaktifkan log dilakukan menggunakan.</p>\n<p><code class=\"language-text\">DB::connection()->enableQueryLog();</code></p>\n<p>Setelah itu kita dapat melihat query yang dijalankan menggunakan\nkode di bawah ini </p>\n<p><code class=\"language-text\">$queries = DB::getQueryLog();</code></p>\n<p>jika ingin melihat query yang terakhir dieksekusi</p>\n<p><code class=\"language-text\">$last_query = end($queries);</code></p>\n<h3 id=\"contoh\" style=\"position:relative;\"><a href=\"#contoh\" aria-label=\"contoh permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contoh</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">show</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Order</span> <span class=\"token variable\">$order</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// aktifkan query log</span>\n    <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>DB</span><span class=\"token operator\">::</span><span class=\"token function\">connection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">enableQueryLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// jalankan model</span>\n    <span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$order</span><span class=\"token operator\">-></span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// tangkap query</span>\n    <span class=\"token variable\">$queries</span> <span class=\"token operator\">=</span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>DB</span><span class=\"token operator\">::</span><span class=\"token function\">getQueryLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">dd</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$queries</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Sumber:<br>\n<a href=\"https://beyondco.de/blog/how-to-get-the-raw-sql-query-from-the-laravel-query-builder\">https://beyondco.de/blog/how-to-get-the-raw-sql-query-from-the-laravel-query-builder</a><br>\n<a href=\"https://stackoverflow.com/questions/41140975/laravel-eloquent-display-query-log\">https://stackoverflow.com/questions/41140975/laravel-eloquent-display-query-log</a></p>","frontmatter":{"title":"Melihat Raw Query Database Eloquent Laravel","date":"February 25, 2022"}}},"pageContext":{"slug":"/2022/02/melihat-raw-query-database-eloquent-laravel/","previous":{"fields":{"slug":"/2022/01/menggunakan-dua-profil-git/"},"frontmatter":{"title":"Menggunakan Dua Profil Git"}},"next":{"fields":{"slug":"/2022/04/membuat-template-email-di-gmail/"},"frontmatter":{"title":"Membuat Template Email di Gmail"}}}},"staticQueryHashes":["2486386679","3128451518"]}