{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023/06/auto-build-deploy-gatsby-site-ke-github-page-dengan-github-action/","result":{"data":{"site":{"siteMetadata":{"title":"Dev Jurnal","author":"mmdmthr","siteUrl":"https://mmdmthr.github.io","comment":{"disqusShortName":"","utterances":"mmdmthr/devjurnal"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"27ef9a9c-e344-5ffa-b4c3-036c9ee933ca","excerpt":"Blog yang sedang Anda baca ini dibuat dengan GatsbyJs dan dihosting di GitHub Pages. \nSebelumnya, deploy site dilakukan secara manual menggunakan perintah  setiap saya menambahkan artikel baru. Auto Deploy Proses ini dapat dibuat otomatis dengan memanfaatkan GitHub Actionsâ€¦","html":"<p>Blog yang sedang Anda baca ini dibuat dengan <a href=\"https://www.gatsbyjs.com/\">GatsbyJs</a> dan dihosting di <a href=\"https://pages.github.com/\">GitHub Pages</a>.\nSebelumnya, deploy site dilakukan secara manual menggunakan perintah <code class=\"language-text\">gatsby build</code> setiap saya menambahkan artikel baru.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">gatsby build --prefix-paths <span class=\"token operator\">&amp;&amp;</span> gh-pages <span class=\"token parameter variable\">-d</span> public</code></pre></div>\n<h3 id=\"auto-deploy\" style=\"position:relative;\"><a href=\"#auto-deploy\" aria-label=\"auto deploy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Auto Deploy</h3>\n<p>Proses ini dapat dibuat otomatis dengan memanfaatkan <a href=\"https://docs.github.com/en/actions\">GitHub Actions</a> workflow.</p>\n<ol>\n<li>\n<p>Buat branch baru <code class=\"language-text\">github-action</code></p>\n<p>Semua perubahan file berkaitan dengan pekerjaan GitHub action akan disimpan di sini.</p>\n</li>\n<li>\n<p>Buat <em>Personal Access Token</em></p>\n<p>Untuk dapat menggunakan <em>workflow</em> ini, kita juga perlu membuat Token Akses. Buka Setting (klik foto profil di pojok kanan atas) -> Developer Settings (paling bawah) -> Generate new token. Pada token classic, kita pilih scope berikut: <code class=\"language-text\">repo</code>, <code class=\"language-text\">workflow</code>, dan <code class=\"language-text\">write: package</code>.</p>\n</li>\n<li>\n<p>Set access token di actions</p>\n<p>Copy <em>secret</em> token. Kemudian kembali ke repositori kita: Settings -> Secrets and Variable -> Actions. Klik tombol <em>new repository secret</em>. Kita atur namanya <code class=\"language-text\">ACCESS_TOKEN</code> yang akan kita gunakan di file <code class=\"language-text\">deploy.yml</code>. </p>\n</li>\n<li>\n<p>Buat file workflow</p>\n<p>Untuk melakukan ini, kita akan membuat file bernama <code class=\"language-text\">deploy.yml</code> di dalam folder <code class=\"language-text\">.github/workflows</code>. </p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gatsby Publish\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> main\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Use Node.js\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'16'</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gatsby Publish\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> enriikke/gatsby<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>action@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">access-token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">deploy-branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">NPM_CONFIG_LEGACY_PEER_DEPS</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>Dalam file ini, kita mendefinisikan bahwa setiap kali melakukan <code class=\"language-text\">push</code> ke branch <code class=\"language-text\">main</code>, kita menjalankan job <a href=\"https://github.com/marketplace/actions/gatsby-publish\">Gatsby Publish</a>. </p>\n<p>Saya menambahkan setup node untuk memastikan proses build menggunakan versi nodejs yang tepat. Saya juga mengeset <code class=\"language-text\">deploy-branch: gh-pages</code> karena itu branch yang saya gunakan untuk mempublikasikan blog. Sementara attribute env <code class=\"language-text\">NPM_CONFIG_LEGACY_PEER_DEPS: true</code> untuk mengantisipasi versi peer dependency yang tidak cocok (namun sebenarnya tetap bisa berfungsi).</p>\n</li>\n<li>\n<p>Buat Pull Request dan Merge</p>\n<p>Setelah semua siap, kita bisa mencoba script tersebut dengan cara melakukan pull request ke branch main. Github akan menampilkan status <em>workflow</em> di bawah tab Actions. Setiap kali kita melakukan push commit baru atau melakukan merge dari branch lain, actions akan melakukan build pada aplikasi kita.</p>\n</li>\n</ol>\n<p>Referensi: <a href=\"https://medium.com/@alpercitak/auto-deploy-gatsby-to-github-pages-1a4d18ac239f\">Auto-Deploy Gatsby to Github Pages</a></p>","frontmatter":{"title":"Auto Build dan Deploy Gatsby Site ke GitHub Page dengan GitHub Action","date":"June 03, 2023"}}},"pageContext":{"slug":"/2023/06/auto-build-deploy-gatsby-site-ke-github-page-dengan-github-action/","previous":{"fields":{"slug":"/2023/05/panduan-facility-dan-severity-dalam-syslog/"},"frontmatter":{"title":"Mengenal RFC 5424 - Panduan untuk Facility dan Severity dalam Syslog"}},"next":{"fields":{"slug":"/2023/06/tipe-tiket-jira/"},"frontmatter":{"title":"Mengenal Tiket Jira: Epic, Story, Bug, Task, dan Subtask dalam Manajemen Proyek"}}}},"staticQueryHashes":["2486386679","3128451518"]}