{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023/01/mengoptimalkan-query-database-laravel/","result":{"data":{"site":{"siteMetadata":{"title":"Dev Jurnal","author":"mmdmthr","siteUrl":"https://mmdmthr.github.io","comment":{"disqusShortName":"","utterances":"mmdmthr/devjurnal"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"9f9de5a9-be76-5fa0-88e3-f686f9676c65","excerpt":"1. Mengambil Data dalam Jumlah Besar Opsi 1: Menggunakan chunk Jika aplikasi perlu memproses jumlah data yang besar, \nkita bisa melakukannya dengan  (potongan). \nFungsi  menjalankan query dalam potongan-potongan \nberdasarkan nilai offset dan limit, ini lebih optimal \ndibandingâ€¦","html":"<h3 id=\"1-mengambil-data-dalam-jumlah-besar\" style=\"position:relative;\"><a href=\"#1-mengambil-data-dalam-jumlah-besar\" aria-label=\"1 mengambil data dalam jumlah besar permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Mengambil Data dalam Jumlah Besar</h3>\n<p><strong>Opsi 1: Menggunakan chunk</strong></p>\n<p>Jika aplikasi perlu memproses jumlah data yang besar,\nkita bisa melakukannya dengan <code class=\"language-text\">chunk</code> (potongan).\nFungsi <code class=\"language-text\">chunk</code> menjalankan query dalam potongan-potongan\nberdasarkan nilai <em>offset</em> dan <em>limit</em>, ini lebih optimal\ndibanding query mengambil semua data di database.\nContoh di bawah mengambil 100 record dari tabel posts,\nmemprosesnya, mengambil 100 record lagi, dan memprosesnya.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">chunk</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// Proses posts</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">chunk</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// Proses posts</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Opsi 2: Menggunakan chunkById</strong></p>\n<p>Kita juga dapat menggunakan <code class=\"language-text\">chunkById</code>. <code class=\"language-text\">chunkById</code> menggunakan field id\nyang merupakan integer (bilangan bulat), dan kueri menggunakan klausa where,\nkueri akan jauh lebih cepat.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">chunkById</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// Proses posts</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">chunkById</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$post</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// Proses posts</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"2-select-hanya-kolom-yang-dibutuhkan\" style=\"position:relative;\"><a href=\"#2-select-hanya-kolom-yang-dibutuhkan\" aria-label=\"2 select hanya kolom yang dibutuhkan permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. <em>Select</em> hanya kolom yang dibutuhkan</h3>\n<p>Gunakan fungsi <code class=\"language-text\">select</code> dalam kueri untuk memilih hanya kolom tertentu\nalih-alih mengambil semua kolom dalam sebuah tabel.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'='</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-></span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code></pre></div>\n<h3 id=\"3-gunakan-code-classlanguage-textpluckcode-saat-membutuhkan-hanya-satu-atau-dua-kolom-dari-database\" style=\"position:relative;\"><a href=\"#3-gunakan-code-classlanguage-textpluckcode-saat-membutuhkan-hanya-satu-atau-dua-kolom-dari-database\" aria-label=\"3 gunakan code classlanguage textpluckcode saat membutuhkan hanya satu atau dua kolom dari database permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Gunakan <code class=\"language-text\">pluck</code> saat membutuhkan hanya satu atau dua kolom dari database</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">pluck</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'slug'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">pluck</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'slug'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ketika kode di atas dijalankan, ia melakukan hal berikut di belakang layar.</p>\n<p>Jalankan <code class=\"language-text\">select title, slug</code> dari kueri posts di database.\nMembuat array dengan title sebagai nilai array dan slug sebagai key array.\nMengembalikan array(format array: [ slug => title, slug => title ])</p>\n<p>Untuk mengakses hasilnya</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$slug</span> <span class=\"token operator\">=></span> <span class=\"token variable\">$title</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// $title post</span>\n    <span class=\"token comment\">// $slug post</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Jika ingin mengambil hanya satu kolom</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">pluck</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">pluck</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$posts</span> <span class=\"token keyword\">as</span>  <span class=\"token variable\">$title</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// $title post</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"4-hitung-jumlah-baris-menggunakan-kueri-bukan-dari-collection\" style=\"position:relative;\"><a href=\"#4-hitung-jumlah-baris-menggunakan-kueri-bukan-dari-collection\" aria-label=\"4 hitung jumlah baris menggunakan kueri bukan dari collection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Hitung jumlah baris menggunakan kueri, bukan dari collection</h3>\n<p>Dengan menggunakan pendekatan ini, kita dapat langsung menghitung\njumlah total baris pada database itu sendiri.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// eloquent</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// query builder</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"5-menggunakan-code-classlanguage-textwithcode-dalam-relasi\" style=\"position:relative;\"><a href=\"#5-menggunakan-code-classlanguage-textwithcode-dalam-relasi\" aria-label=\"5 menggunakan code classlanguage textwithcode dalam relasi permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Menggunakan <code class=\"language-text\">with</code> dalam relasi</h3>\n<p>Jika kita menggunakan relasi dalam model eloquent\nmaka kita harus menggunakan method <code class=\"language-text\">with</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'author'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Demikian pula, jika kita menggunakan hubungan bersarang maka kita dapat menggunakan ini</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'author.team'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"6-jangan-memanggil-relasi-yang-tidak-perlu\" style=\"position:relative;\"><a href=\"#6-jangan-memanggil-relasi-yang-tidak-perlu\" aria-label=\"6 jangan memanggil relasi yang tidak perlu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Jangan memanggil relasi yang tidak perlu</h3>\n<p>Jangan panggil relasi jika kita yakin id relasi ada di tabel.</p>\n<p>Contoh:\nUntuk mendapatkan id penulis dari sebuah posting, biasanya kita lakukan</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">findOrFail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>post id<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token property\">author</span><span class=\"token operator\">-></span><span class=\"token property\">id</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sebagai gantinya, kita bisa langsung mendapatkan id penulis dengan melakukan hal berikut.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">findOrFail</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>post id<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">-></span><span class=\"token property\">author_id</span><span class=\"token punctuation\">;</span> \n<span class=\"token comment\">// table posts memiliki kolom author_id yang menyimpan id penulis</span></code></pre></div>\n<p>Tapi selalu lakukan pengecekan bahwa baris yang dituju ada di tabel penulis\njika direferensikan di tabel posts.</p>\n<h3 id=\"7-tambahkan-indeks-ke-kolom-yang-sering-dikueri\" style=\"position:relative;\"><a href=\"#7-tambahkan-indeks-ke-kolom-yang-sering-dikueri\" aria-label=\"7 tambahkan indeks ke kolom yang sering dikueri permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. Tambahkan indeks ke kolom yang sering dikueri</h3>\n<p>Jika kita melakukan query dengan <code class=\"language-text\">where</code> di sebuah kolom.\nKita bisa menambahkan indeks ke kolom tersebut.\nKueri jauh lebih cepat saat melakukan kueri pada baris dengan kolom indeks.</p>\n<h3 id=\"8-gunakan-simplepaginate-bukan-paginate\" style=\"position:relative;\"><a href=\"#8-gunakan-simplepaginate-bukan-paginate\" aria-label=\"8 gunakan simplepaginate bukan paginate permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. Gunakan simplePaginate, bukan Paginate</h3>\n<p>Paginate Menghasilkan link pagination untuk semua halaman.\nSementara simplePaginate Menghasilkan hanya tautan paginasi berikutnya dan sebelumnya.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// Menghasilkan link pagination untuk semua halaman</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">paginate</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Menghasilkan hanya link pagination next dan previous</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">simplePaginate</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"9-hindari-penggunaan-wildcard-di-awal-dengan-keyword-like\" style=\"position:relative;\"><a href=\"#9-hindari-penggunaan-wildcard-di-awal-dengan-keyword-like\" aria-label=\"9 hindari penggunaan wildcard di awal dengan keyword like permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. Hindari penggunaan wildcard di awal (dengan keyword LIKE)</h3>\n<p>Jika kita mengetahui kata kunci muncul di awal nilai kolom,\nkita dapat menjalankan kueri seperti di bawah ini.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">select</span> * from table_name where <span class=\"token function\">column</span> like keyword%\n<span class=\"token comment\"># bukan %keyword%</span></code></pre></div>\n<h3 id=\"10-hindari-penggunaan-fungsi-sql-pada-klausa-where\" style=\"position:relative;\"><a href=\"#10-hindari-penggunaan-fungsi-sql-pada-klausa-where\" aria-label=\"10 hindari penggunaan fungsi sql pada klausa where permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>10. Hindari penggunaan fungsi SQL pada klausa where</h3>\n<p>Cukup gunakan <code class=\"language-text\">where</code> pada kolom tanggal seperti ini</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// Yes</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// No</span>\n<span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">whereDate</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"11-hindari-menambahkan-terlalu-banyak-kolom-ke-sebuah-tabel\" style=\"position:relative;\"><a href=\"#11-hindari-menambahkan-terlalu-banyak-kolom-ke-sebuah-tabel\" aria-label=\"11 hindari menambahkan terlalu banyak kolom ke sebuah tabel permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>11. Hindari menambahkan terlalu banyak kolom ke sebuah tabel</h3>\n<p>Menambahkan terlalu banyak kolom ke tabel akan menambah sebuah record\ndan akan memperlambat pemindaian tabel. Saat melakukan kueri <code class=\"language-text\">select *</code>,\nkita akhirnya akan mengambil banyak kolom yang sebenarnya tidak diperlukan.\nDalam situasi itu pemecahan tabel akan membantu.</p>\n<h3 id=\"12-pisahkan-kolom-dengan-tipe-data-teks-ke-dalam-tabelnya-sendiri\" style=\"position:relative;\"><a href=\"#12-pisahkan-kolom-dengan-tipe-data-teks-ke-dalam-tabelnya-sendiri\" aria-label=\"12 pisahkan kolom dengan tipe data teks ke dalam tabelnya sendiri permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>12. Pisahkan kolom dengan tipe data teks ke dalam tabelnya sendiri</h3>\n<p>Pertimbangkan kasus di mana kita memiliki tabel yang disebut posting\ndengan kolom konten yang menyimpan konten posting blog.\nKonten untuk posting blog akan sangat besar dan seringkali,\nkita memerlukan data ini hanya jika seseorang melihat\nposting blog tertentu.</p>\n<p>Jadi, memisahkan kolom ini dari tabel posts akan secara drastis\nmeningkatkan performa kueri saat ada terlalu banyak postingan.</p>\n<h3 id=\"13-cara-yang-lebih-baik-untuk-mengambil-baris-terbaru-dari-sebuah-tabel\" style=\"position:relative;\"><a href=\"#13-cara-yang-lebih-baik-untuk-mengambil-baris-terbaru-dari-sebuah-tabel\" aria-label=\"13 cara yang lebih baik untuk mengambil baris terbaru dari sebuah tabel permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>13. Cara yang lebih baik untuk mengambil baris terbaru dari sebuah tabel</h3>\n<p>Jika menggunakan id dalam bentuk integer atau nilai yang berurutan,\ncara yang lebih baik untuk mengambil baris terbaru adalah seperti di bawah ini.\nDibandingkan dengan mengurutkan string (pada field date).</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token variable\">$posts</span> <span class=\"token operator\">=</span> <span class=\"token class-name static-context\">Post</span><span class=\"token operator\">::</span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"14-periksa-dan-optimalkan-kueri\" style=\"position:relative;\"><a href=\"#14-periksa-dan-optimalkan-kueri\" aria-label=\"14 periksa dan optimalkan kueri permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>14. Periksa dan optimalkan kueri</h3>\n<p>Tidak ada satu solusi universal saat mengoptimalkan kueri di laravel.\nHanya kita yang tahu apa yang dilakukan aplikasi kita,\nberapa banyak kueri yang dibuatnya, berapa banyak yang benar-benar digunakan.</p>\n<p>Untuk melakukan ini, kita dapat menggunakan</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">enableQueryLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">dd</span><span class=\"token punctuation\">(</span><span class=\"token class-name static-context\">DB</span><span class=\"token operator\">::</span><span class=\"token function\">getQueryLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol>\n<li><strong>Laravel Debugbar</strong> - Laravel debugbar memiliki tab bernama database\nyang akan menampilkan semua kueri yang dijalankan saat kita mengunjungi sebuah halaman.\nKunjungi semua halaman di aplikasi dan lihat kueri yang dijalankan di setiap halaman.</li>\n<li><strong>Clockwork</strong> - Clockwork sama dengan laravel debugbar.\nTapi alih-alih memberikan toolbar ke situs web,\nitu akan menampilkan informasi debug di <em>developer tools window</em>\natau sebagai UI mandiri dengan mengunjungi <code class=\"language-text\">appurl/clockwork</code>.</li>\n<li><strong>Laravel Telescope</strong> - Setelah Telescope diinstal,\nkita dapat mengakses dasbor dengan mengunjungi\n<code class=\"language-text\">appurl/telescope</code>. Di dasbor telescope, buka tab kueri, dan itu akan\nmenampilkan semua kueri yang dijalankan oleh aplikasi.</li>\n</ol>\n<p><strong><em>Referensi:</em></strong>\n<a href=\"https://dev.to/readymadecode/how-to-optimize-database-queries-in-laravel-3726\">How to Optimize Database Queries in Laravel?</a></p>","frontmatter":{"title":"Mengoptimalkan Query Database di Laravel","date":"January 28, 2023"}}},"pageContext":{"slug":"/2023/01/mengoptimalkan-query-database-laravel/","previous":{"fields":{"slug":"/2023/01/menjalankan-artisan-storage-link-shared-hosting/"},"frontmatter":{"title":"Menjalankan Perintah PHP Artisan Storage Link di Shared Hosting"}},"next":{"fields":{"slug":"/2023/02/membuat-bootable-flashdisk-di-ubuntu-dengan-ventoy/"},"frontmatter":{"title":"Membuat Bootable Flashdisk Windows di Ubuntu dengan Ventoy"}}}},"staticQueryHashes":["2486386679","3128451518"]}